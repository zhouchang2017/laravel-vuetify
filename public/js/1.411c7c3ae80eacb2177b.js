webpackJsonp([1],{"+nl0":function(e,t,n){(e.exports=n("UTlt")(!1)).push([e.i,".quill-editor{height:500px;margin-bottom:20px}input[type=file]{position:absolute;right:0;top:0;opacity:0;filter:alpha(opacity=0);cursor:pointer}",""])},"2EiJ":function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[n("v-card",[n("v-card-text",[n("v-text-field",{attrs:{label:"文章标题",rules:e.titleRules,counter:32,required:""},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}),e._v(" "),n("upload-button",{ref:"fileInput",staticClass:"mx-0",attrs:{accept:"image/*"},on:{getPath:e.getPath}}),e._v(" "),n("v-select",{attrs:{label:"服务器",items:e.nuxts.data,"item-text":"name","item-value":"id",multiple:"","max-height":"400",hint:"选择需要展现的服务器","persistent-hint":"",rules:e.selectedNuxtsRules,chips:"",required:"",loading:e.nuxtBusy},scopedSlots:e._u([{key:"selection",fn:function(t){return[n("v-chip",{key:JSON.stringify(t.item),staticClass:"chip--select-multi",attrs:{close:"",selected:t.selected},on:{input:function(n){e.nuxtSelect({parent:t.parent,item:t.item})}}},[e._v("\n                        "+e._s(t.item.name)+"\n                    ")])]}}]),model:{value:e.selectedNuxts,callback:function(t){e.selectedNuxts=t},expression:"selectedNuxts"}}),e._v(" "),n("v-select",{attrs:{label:"文章类型",items:e.catelogs,"item-text":"name","item-value":"id",multiple:"","max-height":"400",hint:"请选择文章类型","persistent-hint":"",rules:e.selectedCatelogsRules,chips:"",required:""},scopedSlots:e._u([{key:"selection",fn:function(t){return[n("v-chip",{key:JSON.stringify(t.item),staticClass:"chip--select-multi",attrs:{close:"",selected:t.selected},on:{input:function(e){t.parent.selectItem(t.item)}}},[e._v("\n                        "+e._s(t.item.name)+"\n                    ")])]}}]),model:{value:e.selectedCatelogs,callback:function(t){e.selectedCatelogs=t},expression:"selectedCatelogs"}}),e._v(" "),n("v-progress-linear",{attrs:{indeterminate:e.query,query:!0,active:e.uploadProgressShow},model:{value:e.uploadProgress,callback:function(t){e.uploadProgress=t},expression:"uploadProgress"}}),e._v(" "),n("vue-editor",{attrs:{id:"editor",useCustomImageHandler:""},on:{imageAdded:e.handleImageAdded},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),e._v(" "),n("v-switch",{staticClass:"mt-5",attrs:{label:"是否热门(推荐)"},model:{value:e.isHot,callback:function(t){e.isHot=t},expression:"isHot"}}),e._v(" "),n("v-switch",{attrs:{label:"是否隐藏(屏蔽)"},model:{value:e.isHidden,callback:function(t){e.isHidden=t},expression:"isHidden"}})],1),e._v(" "),n("v-divider",{staticClass:"mt-5"}),e._v(" "),n("v-card-actions",[n("v-btn",{attrs:{flat:""},on:{click:e.resetForm}},[e._v("Clear")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{color:"primary",disabled:!e.valid,flat:""},on:{click:e.submit}},[e._v("Submit")])],1)],1)],1)},staticRenderFns:[]}},"4c0s":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("lC5x"),r=n.n(i),s=n("J0Oq"),a=n.n(s),o=n("Ezal"),l=(n.n(o),n("aoQU")),c=n.n(l),u=n("5Tzg"),d=n.n(u);t.default={name:"post-edit",components:{UploadButton:c.a,Upload:d.a,VueEditor:o.VueEditor},data:function(){return{uploadProgress:0,uploadProgressShow:!1,query:!1,toggle_multiple:[],nuxtBusy:!1,valid:!0,title:"",avatar:"",isHot:!1,isHidden:!1,selectedNuxts:[],selectedCatelogs:[],titleRules:[function(e){return!!e||"Title is required"},function(e){return e&&e.length<=64||"Title must be less than 64 characters"}],selectedNuxtsRules:[function(e){return e.length>0||"Service is required"}],selectedCatelogsRules:[function(e){return e.length>0||"Catelogs is required"}],content:"",catelogs:[],nuxts:{}}},methods:{handleImageAdded:function(e,t,n,i){var s=this;return a()(r.a.mark(function a(){var o,l,c,u;return r.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s.query=!0,s.uploadProgressShow=!0,s.uploadProgress=0,s.query=!1,o={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){s.uploadProgress=Math.round(100*e.loaded/e.total),s.uploadProgress>=100&&(s.uploadProgressShow=!1)}},(l=new FormData).append("avatar",e),r.next=9,s.$store.dispatch("file/uploadImage",{formData:l,config:o});case 9:c=r.sent,u=c.data,t.insertEmbed(n,"image",u),i();case 13:case"end":return r.stop()}},a,s)}))()},fetchCatelogs:function(){return this.$store.dispatch("catelog/index")},fetchNuxts:function(){return this.$store.dispatch("nuxt/index")},nuxtSelect:function(e){var t=e.parent,n=e.item;t.selectItem(n)},getPath:function(e){this.avatar=e},submit:function(){var e=this;return a()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.$refs.form.validate()){t.next=5;break}return t.next=3,e.$store.dispatch("post/store",{formDate:e.formDate});case 3:e.$store.dispatch("message/responseMessage",{text:e.$t("post_create_success")}),e.$router.replace({name:"post.index"});case 5:case"end":return t.stop()}},t,e)}))()},resetForm:function(){this.errorMessages=[],this.formHasErrors=!1,this.$refs.form.reset()}},computed:{formDate:function(){return{title:this.title,avatar:this.avatar,nuxts:this.selectedNuxts,catelogs:this.selectedCatelogs,body:this.content,is_hot:this.isHot,hidden:this.isHidden}}},watch:{name:function(){this.errorMessages=[]}},created:function(){var e=this;return a()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetchCatelogs();case 2:return e.catelogs=t.sent,t.next=5,e.fetchNuxts();case 5:e.nuxts=t.sent;case 6:case"end":return t.stop()}},t,e)}))()}}},"5Tzg":function(e,t,n){var i=n("Z0/y")(n("Pe0s"),n("Z58V"),!1,function(e){n("7yce")},null,null);e.exports=i.exports},"7yce":function(e,t,n){var i=n("njG1");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("FIqI")("1a5b35b0",i,!0,{})},CLwS:function(e,t,n){var i=n("NUpW"),r=n("OtAM");n("Mx9c")("keys",function(){return function(e){return r(i(e))}})},IRRR:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-list",{attrs:{"two-line":"",subheader:""}},[e._l(e.files,function(t,i){return n("v-list-tile",{key:t.name,attrs:{avatar:""},on:{click:function(e){}}},[n("v-list-tile-content",[n("v-list-tile-title",[e._v(e._s(t.name))]),e._v(" "),n("v-list-tile-sub-title",[t.showProgress?n("v-progress-linear",{model:{value:t.percentage,callback:function(n){e.$set(t,"percentage",n)},expression:"file.percentage"}}):e._e()],1)],1),e._v(" "),n("v-list-tile-action",[n("v-btn",{directives:[{name:"show",rawName:"v-show",value:"finished"===t.status,expression:"file.status === 'finished'"}],attrs:{flat:"",icon:"",color:"pink"},nativeOn:{click:function(n){e.handleRemove(t)}}},[n("v-icon",[e._v("delete\n        ")])],1)],1)],1)}),e._v(" "),n("v-divider",{attrs:{inset:""}})],2)},staticRenderFns:[]}},JJPf:function(e,t,n){var i=n("Z0/y")(n("4c0s"),n("2EiJ"),!1,function(e){n("gzqH")},null,null);e.exports=i.exports},LYX9:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("a3Yh"),r=n.n(i);t.default={name:"UploadList",props:{files:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload"}},methods:{fileCls:function(e){return["ivu-upload-list-file",r()({},"ivu-upload-list-file-finish","finished"===e.status)]},handleClick:function(e){this.$emit("on-file-click",e)},handlePreview:function(e){this.$emit("on-file-preview",e)},handleRemove:function(e){this.$emit("on-file-remove",e)},format:function(e){var t=e.name.split(".").pop().toLocaleLowerCase()||"",n="document";return["gif","jpg","jpeg","png","bmp","webp"].indexOf(t)>-1&&(n="image"),["mp4","m3u8","rmvb","avi","swf","3gp","mkv","flv"].indexOf(t)>-1&&(n="ios-film"),["mp3","wav","wma","ogg","aac","flac"].indexOf(t)>-1&&(n="ios-musical-notes"),["doc","txt","docx","pages","epub","pdf"].indexOf(t)>-1&&(n="document-text"),["numbers","csv","xls","xlsx"].indexOf(t)>-1&&(n="stats-bars"),["keynote","ppt","pptx"].indexOf(t)>-1&&(n="ios-videocam"),n},parsePercentage:function(e){return parseInt(e,10)}}}},Mx9c:function(e,t,n){var i=n("MITN"),r=n("UusJ"),s=n("xVzf");e.exports=function(e,t){var n=(r.Object||{})[e]||Object[e],a={};a[e]=t(n),i(i.S+i.F*s(function(){n(1)}),"Object",a)}},PbMa:function(e,t,n){(e.exports=n("UTlt")(!1)).push([e.i,"input[type=file][data-v-b5d096be]{position:absolute;left:-99999px}.loading[data-v-b5d096be]{opacity:.4}",""])},Pe0s:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("a3Yh"),r=n.n(i),s=n("rq2b"),a=n.n(s),o=n("ZLEe"),l=n.n(o);function c(e){var t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(e){return t}}function u(e){if("undefined"!=typeof XMLHttpRequest){var t=new XMLHttpRequest,n=e.action;t.upload&&(t.upload.onprogress=function(t){t.total>0&&(t.percent=t.loaded/t.total*100),e.onProgress(t)});var i=new FormData;e.data&&l()(e.data).map(function(t){i.append(t,e.data[t])}),i.append(e.filename,e.file),t.onerror=function(t){e.onError(t)},t.onload=function(){if(t.status<200||t.status>=300)return e.onError(function(e,t,n){var i="fail to post "+e+" "+n.status+"'",r=new Error(i);return r.status=n.status,r.method="post",r.url=e,r}(n,0,t),c(t));e.onSuccess(c(t))},t.open("post",n,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);var r=e.headers||{};for(var s in r)r.hasOwnProperty(s)&&null!==r[s]&&t.setRequestHeader(s,r[s]);t.send(i)}}t.default={name:"Upload",components:{UploadList:a.a},props:{action:{type:String,required:!0},headers:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},data:{type:Object},name:{type:String,default:"file"},withCredentials:{type:Boolean,default:!1},showUploadList:{type:Boolean,default:!0},type:{type:String,validator:function(e){return["select","drag"].includes(e)},default:"select"},format:{type:Array,default:function(){return[]}},accept:{type:String},maxSize:{type:Number},beforeUpload:Function,onProgress:{type:Function,default:function(){return{}}},onSuccess:{type:Function,default:function(){return{}}},onError:{type:Function,default:function(){return{}}},onRemove:{type:Function,default:function(){return{}}},onPreview:{type:Function,default:function(){return{}}},onExceededSize:{type:Function,default:function(){return{}}},onFormatError:{type:Function,default:function(){return{}}},defaultFileList:{type:Array,default:function(){return[]}}},data:function(){return{prefixCls:"ivu-upload",dragOver:!1,fileList:[],tempIndex:1}},computed:{classes:function(){var e;return["ivu-upload",(e={},r()(e,"ivu-upload-select","select"===this.type),r()(e,"ivu-upload-drag","drag"===this.type),r()(e,"ivu-upload-dragOver","drag"===this.type&&this.dragOver),e)]}},methods:{handleClick:function(){this.$refs.input.click()},handleChange:function(e){e.target.files&&console.log(e)},onDrop:function(e){this.dragOver=!1,this.uploadFiles(e.dataTransfer.files)},uploadFiles:function(e){var t=this,n=Array.prototype.slice.call(e);this.multiple||(n=n.slice(0,1)),0!==n.length&&n.forEach(function(e){t.upload(e)})},upload:function(e){var t=this;if(!this.beforeUpload)return this.post(e);var n=this.beforeUpload(e);n&&n.then?n.then(function(n){"[object File]"===Object.prototype.toString.call(n)?t.post(n):t.post(e)},function(){}):!1!==n&&this.post(e)},post:function(e){var t=this;if(this.format.length){var n=e.name.split(".").pop().toLocaleLowerCase();if(!this.format.some(function(e){return e.toLocaleLowerCase()===n}))return this.onFormatError(e,this.fileList),!1}if(this.maxSize&&e.size>1024*this.maxSize)return this.onExceededSize(e,this.fileList),!1;this.handleStart(e),(new FormData).append(this.name,e),u({headers:this.headers,withCredentials:this.withCredentials,file:e,data:this.data,filename:this.name,action:this.action,onProgress:function(n){t.handleProgress(n,e)},onSuccess:function(n){t.handleSuccess(n,e)},onError:function(n,i){t.handleError(n,i,e)}})},handleStart:function(e){e.uid=Date.now()+this.tempIndex++;var t={status:"uploading",name:e.name,size:e.size,percentage:0,uid:e.uid,showProgress:!0};this.fileList.push(t)},getFile:function(e){var t=void 0;return this.fileList.every(function(n){return!(t=e.uid===n.uid?n:null)}),t},handleProgress:function(e,t){var n=this.getFile(t);this.onProgress(e,n,this.fileList),n.percentage=e.percent||0},handleSuccess:function(e,t){var n=this.getFile(t);n&&(n.status="finished",n.response=e,this.dispatch("FormItem","on-form-change",n),this.onSuccess(e,n,this.fileList),setTimeout(function(){n.showProgress=!1},1e3))},handleError:function(e,t,n){var i=this.getFile(n),r=this.fileList;i.status="fail",r.splice(r.indexOf(i),1),this.onError(e,t,n)},handleRemove:function(e){var t=this.fileList;t.splice(t.indexOf(e),1),this.onRemove(e,t)},handlePreview:function(e){"finished"===e.status&&this.onPreview(e)},clearFiles:function(){this.fileList=[]}},watch:{defaultFileList:{immediate:!0,handler:function(e){var t=this;this.fileList=e.map(function(e){return e.status="finished",e.percentage=100,e.uid=Date.now()+t.tempIndex++,e})}}}}},QrCh:function(e,t,n){(e.exports=n("UTlt")(!1)).push([e.i,"",""])},SnQ2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("JJPf"),r=n.n(i);t.default={name:"post_create",data:function(){return{name:this.$t("post_create")}},components:{PostCreate:r.a}}},Z58V:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-flex",{attrs:{xs12:"",sm12:"",lg12:""}},[n("div",{class:e.classes,on:{click:e.handleClick,drop:function(t){return t.preventDefault(),e.onDrop(t)},dragover:function(t){t.preventDefault(),e.dragOver=!0},dragleave:function(t){t.preventDefault(),e.dragOver=!1}}},[n("input",{ref:"input",class:[e.prefixCls+"-input"],attrs:{type:"file",multiple:e.multiple,accept:e.accept},on:{change:e.handleChange}}),e._v(" "),e._t("default",[n("v-card")])],2),e._v(" "),e._t("tip"),e._v(" "),e.showUploadList?n("upload-list",{attrs:{files:e.fileList},on:{"on-file-remove":e.handleRemove,"on-file-preview":e.handlePreview}}):e._e()],2)},staticRenderFns:[]}},ZLEe:function(e,t,n){e.exports={default:n("rhsp"),__esModule:!0}},aoQU:function(e,t,n){var i=n("Z0/y")(n("q2ZW"),n("cZFl"),!1,function(e){n("lWfn")},"data-v-b5d096be",null);e.exports=i.exports},cZFl:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("v-card",[n("v-card-media",{directives:[{name:"show",rawName:"v-show",value:e.imageUrl,expression:"imageUrl"}],ref:"imageUrl",class:{loading:e.loading},staticStyle:{cursor:"pointer"},attrs:{contain:"",src:e.imageUrl,height:"200px"},on:{click:function(t){t.stopPropagation(),e.dialog=!0}}}),e._v(" "),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:0===e.progress,expression:"progress === 0"}],attrs:{large:"",block:"",raised:"",color:"info"},on:{click:e.onPickFile}},[e._v("\n            "+e._s(e.selectLabel)+"\n        ")]),e._v(" "),n("v-progress-linear",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"my-0",attrs:{height:"40",color:e.color},model:{value:e.progress,callback:function(t){e.progress=t},expression:"progress"}}),e._v(" "),n("v-btn",{directives:[{name:"show",rawName:"v-show",value:100===e.progress,expression:"progress === 100"}],staticClass:"error",attrs:{large:"",block:"",raised:""},on:{click:e.removeFile}},[e._v("\n            "+e._s(e.removeLabel)+"\n        ")]),e._v(" "),n("input",{ref:"image",attrs:{type:"file",name:"image",accept:e.accept},on:{change:e.onFilePicked}})],1),e._v(" "),n("v-dialog",{attrs:{fullscreen:"","max-width":"100%",lazy:""},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[n("v-card",{attrs:{"full-height":""}},[n("v-card-title",[n("span",[e._v("图片预览")]),e._v(" "),n("v-spacer"),e._v(" "),n("v-btn",{attrs:{icon:""},on:{click:function(t){t.stopPropagation(),e.dialog=!1}}},[n("v-icon",[e._v("clear")])],1)],1),e._v(" "),n("v-card-media",{class:{loading:e.loading},attrs:{contain:"",src:e.imageUrl,height:e.dialogHeight}}),e._v(" "),n("v-card-actions",[n("v-spacer"),e._v(" "),n("v-btn",{attrs:{flat:""},on:{click:function(t){return t.stopPropagation(),e.removeFile(t)}}},[e._v("Delete")]),e._v(" "),n("v-btn",{attrs:{color:"primary",flat:""},on:{click:function(t){t.stopPropagation(),e.dialog=!1}}},[e._v("Close")])],1)],1)],1)],1)},staticRenderFns:[]}},dv6q:function(e,t){e.exports={render:function(){var e=this.$createElement,t=this._self._c||e;return t("v-card",[t("v-card-title",{staticClass:"grey lighten-4",attrs:{"primary-title":""}},[t("h3",{staticClass:"headline mb-0"},[this._v(this._s(this.name))])]),this._v(" "),t("v-divider"),this._v(" "),t("post-create")],1)},staticRenderFns:[]}},gzqH:function(e,t,n){var i=n("+nl0");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("FIqI")("9ddd714c",i,!0,{})},lWfn:function(e,t,n){var i=n("PbMa");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("FIqI")("20460cd0",i,!0,{})},njG1:function(e,t,n){(e.exports=n("UTlt")(!1)).push([e.i,"input[type=file]{display:none}",""])},nqNL:function(e,t,n){var i=n("Z0/y")(n("SnQ2"),n("dv6q"),!1,function(e){n("xWyv")},"data-v-7cb08fda",null);e.exports=i.exports},q2ZW:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("lC5x"),r=n.n(i),s=n("J0Oq"),a=n.n(s);t.default={props:{value:{type:String},accept:{type:String,default:"*"},selectLabel:{type:String,default:"Select an image"},removeLabel:{type:String,default:"Remove"}},data:function(){return{imageUrl:"",progress:0,loading:!1,dialog:!1}},watch:{},mounted:function(){this.imageUrl=""},computed:{dialogHeight:function(){return this.$vuetify.breakpoint.height-100},color:function(){return["error","warning","success"][Math.floor(this.progress/40)]}},methods:{onPickFile:function(){this.$refs.image.click()},onFilePicked:function(e){var t=this;return a()(r.a.mark(function n(){var i,s,a,o;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(i=e.target.files||e.dataTransfer.files)||!i[0]){n.next=12;break}if(!((s=i[0].name)&&s.lastIndexOf(".")<=0)){n.next=5;break}return n.abrupt("return");case 5:return(a=new FileReader).addEventListener("load",function(){t.imageUrl=a.result}),a.readAsDataURL(i[0]),n.next=10,t.upload(i[0]);case 10:o=n.sent,t.$emit("getPath",o);case 12:case"end":return n.stop()}},n,t)}))()},removeFile:function(){this.imageUrl="",this.progress=0,this.dialog=!1,this.$store.dispatch("message/responseMessage",{text:this.$t("remove_img_success")})},upload:function(e){var t=this;return a()(r.a.mark(function n(){var i,s,a,o;return r.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i=new FormData,s={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){t.progress=Math.round(100*e.loaded/e.total),t.progress>=100&&(t.loading=!1)}},i.append("avatar",e),t.loading=!0,n.next=6,t.$store.dispatch("file/uploadImage",{formData:i,config:s});case 6:return a=n.sent,o=a.data,t.loading=!1,n.abrupt("return",o);case 10:case"end":return n.stop()}},n,t)}))()}}}},rhsp:function(e,t,n){n("CLwS"),e.exports=n("UusJ").Object.keys},rq2b:function(e,t,n){var i=n("Z0/y")(n("LYX9"),n("IRRR"),!1,null,null,null);e.exports=i.exports},xWyv:function(e,t,n){var i=n("QrCh");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("FIqI")("a0d56fa4",i,!0,{})}});